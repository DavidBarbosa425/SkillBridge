<!-- reset-password.component.html -->
<div class="reset-password-container">
  <div class="background-decoration">
    <div class="floating-shape shape-1"></div>
    <div class="floating-shape shape-2"></div>
    <div class="floating-shape shape-3"></div>
    <div class="floating-shape shape-4"></div>
  </div>

  <div class="reset-password-wrapper">
    <div class="logo-section">
      <div class="logo-icon">
        <i class="pi pi-shield"></i>
      </div>
      <h1 class="brand-title">Redefinir Senha</h1>
      <p class="brand-subtitle">Crie uma nova senha segura para sua conta</p>
    </div>

    <!-- Formulário só aparece se os parâmetros forem válidos -->
    <p-card
      *ngIf="hasValidParams"
      class="reset-password-card"
      styleClass="reset-card"
    >
      <div class="card-content">
        <form
          [formGroup]="resetForm"
          (ngSubmit)="onSubmit()"
          class="reset-form"
        >
          <!-- New Password Field -->
          <div class="field-container">
            <label for="newPassword" class="field-label">
              <i class="pi pi-lock"></i>
              Nova Senha
            </label>
            <p-password
              formControlName="newPassword"
              placeholder="Digite sua nova senha"
              [toggleMask]="true"
              [feedback]="true"
              [class.p-invalid]="isFieldInvalid('newPassword')"
              styleClass="w-full"
              inputStyleClass="w-full"
              weakLabel="Fraca"
              mediumLabel="Média"
              strongLabel="Forte"
              promptLabel="Digite uma senha"
            ></p-password>
            <small class="field-error" *ngIf="isFieldInvalid('newPassword')">
              {{ getFieldError('newPassword') }}
            </small>
          </div>

          <!-- Confirm Password Field -->
          <div class="field-container">
            <label for="confirmPassword" class="field-label">
              <i class="pi pi-lock"></i>
              Confirmar Nova Senha
            </label>
            <p-password
              formControlName="confirmPassword"
              placeholder="Confirme sua nova senha"
              [toggleMask]="true"
              [feedback]="false"
              [class.p-invalid]="isFieldInvalid('confirmPassword')"
              styleClass="w-full"
              inputStyleClass="w-full"
            ></p-password>
            <small
              class="field-error"
              *ngIf="isFieldInvalid('confirmPassword')"
            >
              {{ getFieldError('confirmPassword') }}
            </small>
          </div>

          <!-- Security Tips -->
          <div class="security-tips">
            <p class="tips-title">
              <i class="pi pi-info-circle"></i>
              Dicas de Segurança
            </p>
            <ul class="tips-list">
              <li>Use pelo menos 8 caracteres</li>
              <li>Inclua letras maiúsculas e minúsculas</li>
              <li>Adicione números e símbolos especiais</li>
              <li>Evite informações pessoais óbvias</li>
            </ul>
          </div>

          <p-divider></p-divider>

          <!-- Submit Button -->
          <div class="button-container">
            <p-button
              type="submit"
              label="Redefinir Senha"
              icon="pi pi-check"
              [loading]="isLoading"
              loadingIcon="pi pi-spin pi-spinner"
              styleClass="submit-button w-full"
              pRipple
            ></p-button>
          </div>

          <!-- Back to Login Link -->
          <div class="back-link-container">
            <p class="back-text">
              Lembrou da senha?
              <a routerLink="/login" class="back-link">
                <i class="pi pi-arrow-left"></i>
                Voltar ao Login
              </a>
            </p>
          </div>
        </form>
      </div>
    </p-card>

    <!-- Mensagem de link inválido -->
    <p-card
      *ngIf="!hasValidParams"
      class="reset-password-card error-card"
      styleClass="reset-card"
    >
      <div class="card-content">
        <div class="error-content">
          <div class="error-icon">
            <i class="pi pi-exclamation-triangle"></i>
          </div>
          <h2 class="error-title">Link Inválido</h2>
          <p class="error-message">
            O link para redefinir a senha é inválido ou expirou.
            <br />
            Solicite um novo link de recuperação de senha.
          </p>
          <div class="error-actions">
            <p-button
              label="Solicitar Novo Link"
              icon="pi pi-refresh"
              routerLink="/forgot-password"
              styleClass="error-button"
              pRipple
            ></p-button>
            <p-button
              label="Voltar ao Login"
              icon="pi pi-arrow-left"
              routerLink="/login"
              styleClass="secondary-button"
              severity="secondary"
              pRipple
            ></p-button>
          </div>
        </div>
      </div>
    </p-card>
  </div>
</div>
